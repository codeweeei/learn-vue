{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observe/array.js","../src/observe/dep.js","../src/observe/index.js","../src/observe/scheduler.js","../src/observe/watcher.js","../src/state.js","../src/compiler/generate.js","../src/compiler/parser.js","../src/compiler/index.js","../src/vnode/patch.js","../src/lifecycle.js","../src/init.js","../src/vnode/index.js","../src/render.js","../src/index.js"],"sourcesContent":["// 工具库\r\n\r\nexport function isFunction(val) {\r\n\treturn typeof val === 'function';\r\n}\r\n\r\nexport function isObject(val) {\r\n\treturn typeof val === 'object';\r\n\t// return Object.prototype.toString.call(val) === '[object Object]';\r\n}\r\n\r\n// Vue数据异步更新原理\r\nlet callbackFn = [];\r\nlet watting = false; // 防抖\r\nfunction flushCallbacks() {\r\n\tfor (let i = 0; i < callbackFn.length; i++) {\r\n\t\tcallbackFn[i]();\r\n\t}\r\n\tcallbackFn = [];\r\n\twatting = false;\r\n}\r\nexport function nextTick(callback) {\r\n\tcallbackFn.push(callback);\r\n\tif (!watting) {\r\n\t\t// 这里异步vue2中考虑了兼容性问题,这里我们就不考虑浏览器兼容性问题了\r\n\t\tPromise.resolve().then(flushCallbacks);\r\n\t\twatting = true;\r\n\t}\r\n}\r\n","const oldArrayPrototype = Array.prototype;\r\nexport const arrayMethods = Object.create(oldArrayPrototype);\r\n\r\nlet methods = ['push', 'shift', 'unshift', 'pop', 'reverse', 'sort', 'splice'];\r\n\r\nmethods.forEach((method) => {\r\n\t// 重写上述数组方法\r\n\tarrayMethods[method] = function (...args) {\r\n\t\toldArrayPrototype[method].call(this, ...args);\r\n\t\tlet inserted;\r\n\t\tlet ob = this.__ob__;\r\n\t\t// 注意数组新增引用类型数据时，需要对新增的数据进行劫持（push、unshift和splice）\r\n\t\tswitch (method) {\r\n\t\t\tcase 'push':\r\n\t\t\tcase 'unshift':\r\n\t\t\t\tinserted = args;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'splice':\r\n\t\t\t\tinserted = args.slice(2);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (inserted) ob.observeArray(inserted);\r\n\t\tconsole.log(ob);\r\n\t\t// 数组的observer.dep属性\r\n\t\tob.dep.notify();\r\n\t};\r\n});\r\n","let id = 0;\r\n\r\nexport class Dep {\r\n\tconstructor() {\r\n\t\tthis.id = id++; // 保证每个dep的唯一性\r\n\t\tthis.subs = []; // 用来存放watcher\r\n\t}\r\n\t// 向 watcher 中添加 dep\r\n\tdepend() {\r\n\t\tif (Dep.target) {\r\n\t\t\tDep.target.addDep(this);\r\n\t\t}\r\n\t}\r\n\taddSub(watcher) {\r\n\t\tthis.subs.push(watcher);\r\n\t}\r\n\t// 通知更新视图\r\n\tnotify() {\r\n\t\tthis.subs.forEach((watcher) => {\r\n\t\t\twatcher.update();\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * 当前正在执行的 watcher，同一时间只会有一个 watcher 在执行\r\n * Dep.target = 当前正在执行的 watcher\r\n * 通过调用 pushTarget 方法完成赋值，调用 popTarget 方法完成重置（null)\r\n */\r\n\r\nDep.target = null;\r\nexport function pushTarget(watcher) {\r\n\tDep.target = watcher;\r\n}\r\nexport function popTarget() {\r\n\tDep.target = null;\r\n}\r\n","// 观测data，进行数据劫持\r\nimport { isObject } from '../utils';\r\nimport { arrayMethods } from './array';\r\nimport { Dep } from './dep';\r\n\r\n// 观测者类：检测数据的变化（类存在类型）\r\nexport class Observe {\r\n\tconstructor(data) {\r\n\t\tthis.dep = new Dep(); // 数据可能是对象或数组\r\n\t\t// 将观测实例作为属性保存至观测的对象，注意该属性不能被枚举，否则会陷入this.walk(data)中的死循环\r\n\t\tObject.defineProperty(data, '__ob__', {\r\n\t\t\tvalue: this,\r\n\t\t\tenumerable: false,\r\n\t\t});\r\n\t\t// 对 data 中的所有属性进行劫持（注意数组的递归监控）\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tdata.__proto__ = arrayMethods;\r\n\t\t\t// 对数组中的引用类型进行劫持\r\n\t\t\tthis.observeArray(data);\r\n\t\t} else {\r\n\t\t\tthis.walk(data);\r\n\t\t}\r\n\t}\r\n\tobserveArray(data) {\r\n\t\tdata.forEach((item) => observe(item));\r\n\t}\r\n\t// 遍历数据的所有属性，并调用defineReactive方法\r\n\twalk(data) {\r\n\t\tObject.keys(data).forEach((key) => {\r\n\t\t\tdefineReactive(data, key, data[key]);\r\n\t\t});\r\n\t}\r\n}\r\n// 数组值为引用类型时，依赖收集\r\nfunction dependArray(value) {\r\n\tfor (let i = 0; i < value.length; i++) {\r\n\t\tlet current = value[i]; // current是数组里面的数组 [[[[[]]]]]\r\n\t\tcurrent.__ob__ && current.__ob__.dep.depend();\r\n\t\tif (Array.isArray(current)) {\r\n\t\t\tdependArray(current);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction defineReactive(data, key, val) {\r\n\t// val可能也是对象，因此需要递归处理嵌套val里的对象，劫持深层val里的对象\r\n\tlet childOb = observe(val);\r\n\t//dep 存储依赖的变量，每个属性字段都有一个属于自己的dep，用于收集属于该字段的依赖\r\n\tlet dep = new Dep();\r\n\tObject.defineProperty(data, key, {\r\n\t\tget() {\r\n\t\t\t//如果存在需要被收集的依赖\r\n\t\t\tif (Dep.target) {\r\n\t\t\t\t/* 将依赖收集到该属性的 dep 中 */\r\n\t\t\t\tdep.depend();\r\n\t\t\t\tif (childOb) {\r\n\t\t\t\t\t// childOb 可能是数组，可能是对象，对象本身也要收集依赖（$set）\r\n\t\t\t\t\tchildOb.dep.depend();\r\n\t\t\t\t\tif (Array.isArray(val)) {\r\n\t\t\t\t\t\t// 嵌套数组也进行依赖收集\r\n\t\t\t\t\t\tdependArray(val);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn val;\r\n\t\t},\r\n\t\tset(newVal) {\r\n\t\t\t// data中某个属性赋值给一个新对象时也得劫持 vm._data.a = {b:1}\r\n\t\t\tif (newVal !== val) {\r\n\t\t\t\tobserve(newVal);\r\n\t\t\t\tval = newVal;\r\n\t\t\t\t//在set方法中执行依赖器中的所有依赖\r\n\t\t\t\tdep.notify();\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n}\r\n\r\nexport function observe(data) {\r\n\t// 判断是否是对象\r\n\tif (!isObject(data)) return;\r\n\tif (data.__ob__) return data.__ob__;\r\n\treturn new Observe(data);\r\n}\r\n","import { nextTick } from '../utils';\r\n\r\n// watcher调度相关\r\nlet queue = [];\r\nlet has = {};\r\nlet pending = false; // 防抖作用\r\n\r\nfunction flushSchedulerQueue() {\r\n\tfor (let i = 0; i < queue.length; i++) {\r\n\t\tqueue[i].run();\r\n\t}\r\n\tqueue = [];\r\n\thas = {};\r\n\tpending = false;\r\n}\r\n\r\nexport function queueWatcher(watcher) {\r\n\t// watcher 去重\r\n\tlet id = watcher.id;\r\n\t// has[id] == null\r\n\tif (has[id] === undefined || has[id] === null) {\r\n\t\tqueue.push(watcher);\r\n\t\thas[id] = true;\r\n\t\t// 开启更新（防抖）\r\n\t\tif (!pending) {\r\n\t\t\t// 注意异步执行顺序 微任务\r\n\t\t\tnextTick(flushSchedulerQueue);\r\n\t\t\tpending = true;\r\n\t\t}\r\n\t}\r\n}\r\n","import { popTarget, pushTarget } from './dep';\r\nimport { queueWatcher } from './scheduler';\r\n\r\n// vm,updateComponent,function () {console.log('更新成功');},true\r\nlet id = 0;\r\n\r\n// 每个组件渲染的时候都会对应一个watcher\r\nexport class Watcher {\r\n\tconstructor(vm, exprOrFn, cb, options) {\r\n\t\tthis.vm = vm;\r\n\t\t// exprOrFn值为字符串（watch）或updateComponent方法\r\n\t\tthis.exprOrFn = exprOrFn;\r\n\t\tthis.user = !!options.user; // 表示是否是用户watcher\r\n\t\tthis.cb = cb;\r\n\t\tthis.options = options;\r\n\t\tthis.id = id++;\r\n\t\tthis.deps = []; // 依赖的属性\r\n\t\tthis.depsId = new Set();\r\n\t\tif (typeof exprOrFn === 'string') {\r\n\t\t\tthis.getter = function () {\r\n\t\t\t\t// 当数据取值时，会进行依赖收集\r\n\t\t\t\t// 注意 age.n 嵌套的情况：vm['age.n'] -> vm['age']['n']\r\n\t\t\t\tlet path = exprOrFn.split('.');\r\n\t\t\t\tlet obj = vm;\r\n\t\t\t\tfor (let i = 0; i < path.length; i++) {\r\n\t\t\t\t\tobj = obj[path[i]];\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tthis.getter = exprOrFn;\r\n\t\t}\r\n\t\t// 默认初始化取值(第一次取值)\r\n\t\tthis.value = this.get();\r\n\t}\r\n\t// 用户更新数据时重新调用即可\r\n\tget() {\r\n\t\t// 一个watcher可以监听多个属性，一个属性可以对应多个watcher；因此使用dep来收集依赖\r\n\t\tpushTarget(this);\r\n\t\tconst value = this.getter();\r\n\t\tpopTarget();\r\n\t\treturn value;\r\n\t}\r\n\t// 更新视图\r\n\tupdate() {\r\n\t\t// 多次调用update时，可以先将watcher缓存下来，等会一起更新\r\n\t\tqueueWatcher(this);\r\n\t}\r\n\trun() {\r\n\t\tlet newValue = this.get();\r\n\t\tlet oldValue = this.value;\r\n\t\tthis.value = newValue; // 为了保证下一次更新时\r\n\t\tif (this.user) {\r\n\t\t\t// 用户watcher\r\n\t\t\tthis.cb.call(this.vm, newValue, oldValue);\r\n\t\t}\r\n\t}\r\n\taddDep(dep) {\r\n\t\tlet id = dep.id;\r\n\t\tif (!this.depsId.has(id)) {\r\n\t\t\tthis.depsId.add(id);\r\n\t\t\tthis.deps.push(dep);\r\n\t\t\tdep.addSub(this);\r\n\t\t}\r\n\t}\r\n}\r\n","import { isFunction } from './utils';\r\nimport { observe } from './observe/index';\r\nimport { Watcher } from './observe/watcher';\r\n\r\nexport function stateMixin(Vue) {\r\n\tVue.prototype.$watch = function (key, handler, options = {}) {\r\n\t\toptions.user = true; // 用户watcher，与渲染watcher区分开\r\n\t\tnew Watcher(this, key, handler, options);\r\n\t};\r\n}\r\n// 处理 new Vue({...})中传入的props、data、computed、watch等\r\nexport function initState(vm) {\r\n\tconst opts = vm.$options;\r\n\tif (opts.data) {\r\n\t\t// 初始化data\r\n\t\tinitData(vm);\r\n\t}\r\n\tif (opts.watch) {\r\n\t\t// 初始化 watche\r\n\t\tinitWatch(vm, opts.watch);\r\n\t}\r\n}\r\n\r\n// 将data代理至vm实例上\r\nfunction proxyDataToVm(vm, source, key) {\r\n\tObject.defineProperty(vm, key, {\r\n\t\tget() {\r\n\t\t\treturn vm[source][key];\r\n\t\t},\r\n\t\tset(val) {\r\n\t\t\tvm[source][key] = val;\r\n\t\t},\r\n\t});\r\n}\r\n\r\n// 处理 data\r\nfunction initData(vm) {\r\n\t// data可传入函数（返回对象）或者对象，最终取到对象（注意函数内部的this指向）\r\n\tlet data = vm.$options.data;\r\n\t// 关联 data（响应式数据getter和setter） 和 vm._data\r\n\tvm._data = data = isFunction(data) ? data.call(vm) : data;\r\n\t// 代理data至vm\r\n\tfor (let key in data) {\r\n\t\tproxyDataToVm(vm, '_data', key);\r\n\t}\r\n\t// 观测data（将其转换为响应式数据）\r\n\tobserve(data);\r\n}\r\n\r\n// 处理 watch\r\nfunction initWatch(vm, watch) {\r\n\t// watch需要为对象\r\n\tObject.keys(watch).forEach((key) => {\r\n\t\tlet handler = watch[key];\r\n\t\tif (Array.isArray(handler)) {\r\n\t\t\tfor (let i = 0; i < handler.length; i++) {\r\n\t\t\t\tcreateWatcher(vm, key, handler[i]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcreateWatcher(vm, key, handler);\r\n\t\t}\r\n\t});\r\n}\r\n// 创建watcher\r\nfunction createWatcher(vm, key, handler) {\r\n\treturn vm.$watch(key, handler);\r\n}\r\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; // 匹配{{}}语法 {{aaaaa}}\r\n\r\n/**\r\n * 将ast树中标签的属性数组拼接成字符串，注意属性值需要使用JSON.stringify进行修饰\r\n * 注意 style属性 style=\"color:red;background:blue\" 需要转成 style: {'color': 'red','background': 'blue'}\r\n * @param {*} attrs [{name: 'id',value: 'app'},{name: 'a',value: '1'}]\r\n * @return str 拼接的字符串 {id: 'app', a='1'}\r\n */\r\nfunction genProps(attrs) {\r\n\tlet str = '';\r\n\tfor (let i = 0; i < attrs.length; i++) {\r\n\t\tlet attr = attrs[i];\r\n\t\tif (attr.name === 'style') {\r\n\t\t\tlet styleObj = {};\r\n\t\t\t// 将color:red;background:blue -> {'color': 'red','background': 'blue'}\r\n\t\t\tattr.value.replace(/([^:;]+)\\:([^:;]+)/g, function () {\r\n\t\t\t\tstyleObj[arguments[1]] = arguments[2];\r\n\t\t\t});\r\n\t\t\tattr.value = styleObj;\r\n\t\t}\r\n\t\tstr += `${attr.name}:${JSON.stringify(attr.value)},`;\r\n\t}\r\n\t// str.slice(0, -1): 截取str第一个字符至倒数第一个字符，即去除最后的,\r\n\treturn `{${str.slice(0, -1)}}`;\r\n}\r\n\r\nfunction gen(el) {\r\n\tif (el.type === 1) {\r\n\t\t// 标签元素\r\n\t\treturn generate(el);\r\n\t} else {\r\n\t\t// 文本类型元素：注意hello{{xxx}}world语法里的xxx是变量，不应该保存为字符串\r\n\t\t// hello{{xxx}}world -> 'hello' + xxx + 'world'\r\n\t\tlet text = el.text;\r\n\t\tif (defaultTagRE.test(text)) {\r\n\t\t\tlet tokens = [];\r\n\t\t\tlet match;\r\n\t\t\t// 注意每次循环正则的exec方法前需要将正则的lastIndex重置为0\r\n\t\t\tlet lastIndex = (defaultTagRE.lastIndex = 0);\r\n\t\t\twhile ((match = defaultTagRE.exec(text))) {\r\n\t\t\t\t// hello{{xxx}}world\r\n\t\t\t\tlet index = match.index; // 获取匹配到{{}}的索引\r\n\t\t\t\tif (index > lastIndex) {\r\n\t\t\t\t\ttokens.push(JSON.stringify(text.slice(lastIndex, index))); // 取出'hello'\r\n\t\t\t\t}\r\n\t\t\t\t// 注意xxx中可能是对象，对象->字符串：[object object]；所以内部需要再处理一下xxx，这里我们约定使用_s()函数来处理\r\n\t\t\t\ttokens.push(`_s(${match[1].trim()})`);\r\n\t\t\t\tlastIndex = index + match[0].length; // match[0] -> {{xxx}}\r\n\t\t\t\tif (lastIndex < text.length) {\r\n\t\t\t\t\ttokens.push(JSON.stringify(text.slice(lastIndex))); // 取出'world'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn `_v(${tokens.join('+')})`;\r\n\t\t} else {\r\n\t\t\treturn `_v(${text})`;\r\n\t\t}\r\n\t}\r\n}\r\n/**\r\n * 获取子元素（type类型为1的）\r\n * @param {*} el\r\n */\r\nfunction genChildren(el) {\r\n\tlet children = el.children;\r\n\tif (children) {\r\n\t\treturn children.map((c) => gen(c)).join(',');\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * ! 导出函数\r\n * 遍历ast树，将树先拼接成字符串，然后通过 new Funtion(字符串)来生成 render函数\r\n * _c(...)表示创建标签节点，_v(...)创建文本节点，_s(...)表示处理{{xxx}}里的xxx\r\n * <div id=\"app\" style=\"color:red;background:blue\">hello{{aaa}}world</div> 需要返回转成如下\r\n * _c('div',{id:\"app\",style:{\"color\":\"red\",\"background\":\"blue\"}},_v(\"hello\"+_s(aaa)+\"world\"))\r\n * @param {*} el\r\n * @return 字符串\r\n */\r\n\r\nexport function generate(el) {\r\n\tlet children = genChildren(el);\r\n\tlet code = `_c('${el.tagName}',${\r\n\t\tel.attrs.length ? genProps(el.attrs) : 'undefined'\r\n\t}${children ? `,${children}` : ''})`;\r\n\treturn code;\r\n}\r\n","// 模板编译\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //  用来获取的标签名的 match后的索引为1的\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 匹配开始标签的：<div\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配闭合标签的\r\n// 用来匹配属性的，可匹配 a=\"xxx\" | a='xxx' | a=xxx\r\nconst attribute =\r\n\t/^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\nconst startTagClose = /^\\s*(\\/?)>/; //  匹配标签闭合  > 或 />\r\n\r\n// 将解析后的结果，组装成一个树结构（利用栈结构的入栈和出栈最终生成一个树节点root对象）\r\nfunction createAstElement(tagName, attrs) {\r\n\treturn {\r\n\t\ttagName,\r\n\t\ttype: 1,\r\n\t\tchildren: [],\r\n\t\tparent: null,\r\n\t\tattrs,\r\n\t};\r\n}\r\n\r\nlet root = null; // 根节点\r\nlet stack = []; // 树结构\r\n// 解析开始标签：获取开始标签名和属性键值对\r\nfunction start(tagName, attributes) {\r\n\t// 循环引用\r\n\tlet parent = stack[stack.length - 1];\r\n\tlet element = createAstElement(tagName, attributes);\r\n\telement.parent = parent;\r\n\tif (parent) {\r\n\t\tparent.children.push(element);\r\n\t}\r\n\tif (!root) {\r\n\t\troot = element;\r\n\t}\r\n\tstack.push(element);\r\n}\r\n// 解析结束标签：获取结束标签名\r\nfunction end(tagName) {\r\n\t// 弹出栈中最后一个\r\n\tlet element = stack.pop();\r\n\tif (tagName !== element.tagName) {\r\n\t\tthrow new Error('标签有误，没有闭合');\r\n\t}\r\n}\r\n// 解析文本标签：获取标签中的文本\r\nfunction chars(text) {\r\n\t// 去除文本中的空格\r\n\ttext = text.replace(/\\s/g, '');\r\n\tlet parent = stack[stack.length - 1];\r\n\tif (text) {\r\n\t\tparent.children.push({\r\n\t\t\ttype: 3,\r\n\t\t\ttext,\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// 解析模板字符串，生成AST树 <div id=\"app\">{{name}}</div>\r\nexport function parserHTML(html) {\r\n\t// 截取字符串（删除匹配完的部分）\r\n\tfunction advance(len) {\r\n\t\thtml = html.substring(len);\r\n\t}\r\n\t// 解析开始标签：获取开始标签名和属性键值对数组\r\n\tfunction parseStartTag() {\r\n\t\tconst start = html.match(startTagOpen);\r\n\t\tif (start) {\r\n\t\t\tconst match = {\r\n\t\t\t\ttagName: start[1],\r\n\t\t\t\tattrs: [],\r\n\t\t\t};\r\n\t\t\tadvance(start[0].length); // 截去<div html -> id=\"app\">{{name}}</div>\r\n\t\t\t// 匹配属性：没有遇到>或/>时并且可以匹配到属性时将匹配到的属性名和值保存在attrs\r\n\t\t\tlet end; // 匹配闭合标签符号\r\n\t\t\tlet attr; // 匹配属性\r\n\t\t\twhile (\r\n\t\t\t\t!(end = html.match(startTagClose)) &&\r\n\t\t\t\t(attr = html.match(attribute))\r\n\t\t\t) {\r\n\t\t\t\tmatch.attrs.push({\r\n\t\t\t\t\tname: attr[1],\r\n\t\t\t\t\tvalue: attr[3] || attr[4] || attr[5],\r\n\t\t\t\t});\r\n\t\t\t\t// 截去匹配的属性等式: id=\"app\" -> >{{name}}</div>\r\n\t\t\t\tadvance(attr[0].length);\r\n\t\t\t}\r\n\t\t\t// 截去匹配到的开始标签结束的>符号 -> {{name}}</div>\r\n\t\t\tif (end) advance(end[0].length);\r\n\t\t\treturn match;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t// 解析结束标签：获取结束标签名\r\n\tfunction parseEndTag() {\r\n\t\tconst end = html.match(endTag);\r\n\t\tif (end) {\r\n\t\t\tadvance(end[0].length);\r\n\t\t\treturn end[1];\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t// 每解析一部分就删除解析完的那部分\r\n\twhile (html) {\r\n\t\tlet textEnd = html.indexOf('<');\r\n\t\tif (textEnd === 0) {\r\n\t\t\t// 解析开始标签：获取标签名和属性键值对数组\r\n\t\t\tconst startTagMatch = parseStartTag();\r\n\t\t\tif (startTagMatch) {\r\n\t\t\t\tstart(startTagMatch.tagName, startTagMatch.attrs);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t// 解析结束标签：获取结束标签名\r\n\t\t\tconst endTagMatch = parseEndTag();\r\n\t\t\tif (endTagMatch) {\r\n\t\t\t\tend(endTagMatch);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet text;\r\n\t\tif (textEnd > 0) {\r\n\t\t\t// {{name}}</div>\r\n\t\t\ttext = html.substring(0, textEnd); // {{name}}\r\n\t\t}\r\n\t\tif (text) {\r\n\t\t\tchars(text);\r\n\t\t\tadvance(text.length); // </div>\r\n\t\t}\r\n\t}\r\n\treturn root;\r\n}\r\n","import { generate } from './generate';\r\nimport { parserHTML } from './parser';\r\n\r\n// html词法解析（开始标签、结束标签、属性和文本） -> ast语法树（用来描述html语法）-> code字符串 -> render函数 -> vdom -> 生成真实dom\r\nexport function compilerToFunction(template) {\r\n\t// 获取根ast语法树\r\n\tlet root = parserHTML(template);\r\n\t// generate 生成code 用来生成render函数\r\n\tlet code = generate(root);\r\n\tlet render = new Function(`with(this){return ${code}}`); // code中可能使用到数据，数据在vm上\r\n\treturn render;\r\n}\r\n","/**\r\n * 比较新旧节点，如果旧节点是真实节点，则直接删除旧节点，将新节点\r\n * @param {*} oldVnode 旧节点\r\n * @param {*} vnode 新节点\r\n */\r\nexport function patch(oldVnode, vnode) {\r\n\tif (oldVnode.nodeType === 1) {\r\n\t\t// 真实元素\r\n\t\tconst parentElm = oldVnode.parentNode;\r\n\t\tlet elm = creatElm(vnode); // 根据虚拟节点，创建真实节点\r\n\t\tparentElm.insertBefore(elm, oldVnode.nextSibling); // 将真实节点插入至父元素下\r\n\t\t// 删除旧的真实元素\r\n\t\tparentElm.removeChild(oldVnode);\r\n\t\treturn elm;\r\n\t}\r\n}\r\n\r\nfunction creatElm(vnode) {\r\n\tlet { tag, data, children, text, vm } = vnode;\r\n\tif (typeof tag === 'string') {\r\n\t\t// 创建元素标签\r\n\t\tvnode.el = document.createElement(tag); // 虚拟节点的el属性指向真实节点\r\n\t\tchildren.forEach((child) => {\r\n\t\t\t// 将children遍历生成真实节点并添加至虚拟节点生成的真实节点\r\n\t\t\tvnode.el.appendChild(creatElm(child));\r\n\t\t});\r\n\t} else {\r\n\t\t// 创建文本标签\r\n\t\tvnode.el = document.createTextNode(text);\r\n\t}\r\n\treturn vnode.el;\r\n}\r\n","import { Watcher } from './observe/watcher';\r\nimport { nextTick } from './utils';\r\nimport { patch } from './vnode/patch';\r\n\r\nexport function lifecycleMixin(Vue) {\r\n\tVue.prototype._update = function (vnode) {\r\n\t\t// 初始化及更新\r\n\t\tconst vm = this;\r\n\t\tvm.$el = patch(vm.$el, vnode);\r\n\t};\r\n\tVue.prototype.$nextTick = nextTick;\r\n}\r\n\r\n// 挂载vm组件至el上\r\nexport function mountComponent(vm, el) {\r\n\t// 调用render方法，生成虚拟DOM再渲染成真实DOM替换掉页面的内容\r\n\tlet updateComponent = () => {\r\n\t\t// 后续更新可以调用updateComponent方法\r\n\t\tvm._update(vm._render());\r\n\t};\r\n\t// 观察者模式\r\n\tnew Watcher(\r\n\t\tvm,\r\n\t\tupdateComponent,\r\n\t\tfunction () {\r\n\t\t\tconsole.log('更新成功');\r\n\t\t},\r\n\t\ttrue // true 表示渲染watcher\r\n\t);\r\n}\r\n","import { initState } from './state';\r\nimport { compilerToFunction } from './compiler/index';\r\nimport { mountComponent } from './lifecycle';\r\n\r\n// 初始化vue\r\nexport function initMixin(Vue) {\r\n\t// 初始化state\r\n\tVue.prototype._init = function (options) {\r\n\t\tconst vm = this;\r\n\t\t// 将options放置vm的$options上\r\n\t\tvm.$options = options;\r\n\t\t// 对数据进行初始化\r\n\t\tinitState(vm);\r\n\r\n\t\t// 处理el，将数据挂载在el指向的模板上\r\n\t\tif (vm.$options.el) {\r\n\t\t\tvm.$mount(vm.$options.el);\r\n\t\t}\r\n\t};\r\n\tVue.prototype.$mount = function (el) {\r\n\t\t// 获取模板\r\n\t\tconst vm = this;\r\n\t\tconst options = vm.$options;\r\n\t\tel = document.querySelector(el);\r\n\t\tvm.$el = el;\r\n\t\t// 将模板转换为渲染函数（render），用于创建虚拟节点，增加渲染模板的性能\r\n\t\tif (!options.render) {\r\n\t\t\t// 用户没有传入render函数时使用template模板\r\n\t\t\tlet template = options.template;\r\n\t\t\tif (!template && el) {\r\n\t\t\t\t// 用户没有传入template模板时将el作为template\r\n\t\t\t\ttemplate = el.outerHTML; // outerHTML 不带空格\r\n\t\t\t\t// 将模板转为render渲染函数\r\n\t\t\t\tlet render = compilerToFunction(template);\r\n\t\t\t\toptions.render = render;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 将vm组件挂载在el上\r\n\t\tmountComponent(vm, el);\r\n\t};\r\n}\r\n","export function createElement(vm, tag, data = {}, ...children) {\r\n\treturn vnode(vm, tag, data, data.key, children, undefined);\r\n}\r\n\r\nexport function createTextElement(vm, text) {\r\n\treturn vnode(vm, undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\n/**\r\n * ! 生成虚拟DOM节点对象\r\n * { tag,data,key,children,text }\r\n * @param {*} vm\r\n */\r\nexport function vnode(vm, tag, data, key, children, text) {\r\n\treturn {\r\n\t\tvm,\r\n\t\ttag,\r\n\t\tdata,\r\n\t\tkey,\r\n\t\tchildren,\r\n\t\ttext,\r\n\t};\r\n}\r\n","import { createElement, createTextElement } from './vnode/index';\r\n\r\nexport function renderMixin(Vue) {\r\n\tVue.prototype._c = function () {\r\n\t\t// 生成vnode\r\n\t\treturn createElement(this, ...arguments);\r\n\t};\r\n\tVue.prototype._v = function (text) {\r\n\t\t// 生成vnode\r\n\t\treturn createTextElement(this, text);\r\n\t};\r\n\tVue.prototype._s = function (val) {\r\n\t\tif (typeof val === 'object') return JSON.stringify(val);\r\n\t\treturn val;\r\n\t};\r\n\tVue.prototype._render = function () {\r\n\t\tconst vm = this;\r\n\t\t// 取出render函数（根据模板解析出来或者用户自己写的）\r\n\t\tlet render = vm.$options.render;\r\n\t\tlet vnode = render.call(vm);\r\n\t\treturn vnode;\r\n\t};\r\n}\r\n","import { initMixin } from './init';\r\nimport { lifecycleMixin } from './lifecycle';\r\nimport { renderMixin } from './render';\r\nimport { stateMixin } from './state';\r\n\r\nfunction Vue(options) {\r\n\t// 调用 Vue.prototype._init 方法，该方法是在 initMixin 中定义的\r\n\tthis._init(options);\r\n}\r\n\r\n// 定义 Vue.prototype._init 方法\r\ninitMixin(Vue); // _init\r\nrenderMixin(Vue); // _render\r\nlifecycleMixin(Vue); // _update\r\nstateMixin(Vue); // $watch\r\n\r\nexport default Vue;\r\n"],"names":["isFunction","val","isObject","callbackFn","watting","flushCallbacks","i","length","nextTick","callback","push","Promise","resolve","then","oldArrayPrototype","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","call","inserted","ob","__ob__","slice","observeArray","console","log","dep","notify","id","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","Observe","data","defineProperty","value","enumerable","isArray","__proto__","walk","item","observe","keys","key","defineReactive","dependArray","current","depend","childOb","get","set","newVal","queue","has","pending","flushSchedulerQueue","run","queueWatcher","undefined","Watcher","vm","exprOrFn","cb","options","user","deps","depsId","Set","getter","path","split","obj","newValue","oldValue","add","addSub","stateMixin","Vue","$watch","handler","initState","opts","$options","initData","watch","initWatch","proxyDataToVm","source","_data","createWatcher","defaultTagRE","genProps","attrs","str","attr","name","styleObj","replace","arguments","JSON","stringify","gen","el","type","generate","text","test","tokens","match","lastIndex","exec","index","trim","join","genChildren","children","map","c","code","tagName","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createAstElement","parent","root","stack","start","attributes","element","end","pop","Error","chars","parserHTML","html","advance","len","substring","parseStartTag","parseEndTag","textEnd","indexOf","startTagMatch","endTagMatch","compilerToFunction","template","render","Function","patch","oldVnode","vnode","nodeType","parentElm","parentNode","elm","creatElm","insertBefore","nextSibling","removeChild","tag","document","createElement","child","appendChild","createTextNode","lifecycleMixin","_update","$el","$nextTick","mountComponent","updateComponent","_render","initMixin","_init","$mount","querySelector","outerHTML","createTextElement","renderMixin","_c","_v","_s"],"mappings":"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"}