{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["// 工具库\r\n\r\nexport function isFunction(val) {\r\n\treturn typeof val === 'function';\r\n}\r\n\r\nexport function isObject(val) {\r\n\treturn Object.prototype.toString.call(val) === '[object Object]';\r\n}\r\n","// 观测data，进行数据劫持\r\nimport { isObject } from '../utils';\r\n\r\n// 观测者类：检测数据的变化（类存在类型）\r\nexport class Observe {\r\n\tconstructor(data) {\r\n\t\t// 对 data 中的所有属性进行劫持\r\n\t\tthis.walk(data);\r\n\t}\r\n\twalk(data) {\r\n\t\tObject.keys(data).forEach((key) => {\r\n\t\t\tdefineReactive(data, key, data[key]);\r\n\t\t});\r\n\t}\r\n}\r\nfunction defineReactive(data, key, val) {\r\n\t// val可能也是对象，因此需要递归处理嵌套val里的对象，劫持深层val里的对象\r\n\tobserve(val);\r\n\tObject.defineProperty(data, key, {\r\n\t\tget() {\r\n\t\t\treturn val;\r\n\t\t},\r\n\t\tset(newVal) {\r\n\t\t\t// data中某个属性赋值给一个新对象时也得劫持 vm._data.a = {b:1}\r\n\t\t\tobserve(newVal);\r\n\t\t\tval = newVal;\r\n\t\t},\r\n\t});\r\n}\r\n\r\nexport function observe(data) {\r\n\t// 判断是否是对象\r\n\tif (!isObject(data)) return;\r\n\treturn new Observe(data);\r\n}\r\n","import { isFunction } from './utils';\r\nimport { observe } from './observe/index';\r\n\r\n// 处理 new Vue({...})中传入的props、data、computed、watch等\r\nexport function initState(vm) {\r\n\tconst opts = vm.$options;\r\n\tif (opts.data) {\r\n\t\tinitData(vm);\r\n\t}\r\n}\r\n\r\n// 处理 data\r\nfunction initData(vm) {\r\n\t// data可传入函数（返回对象）或者对象，最终取到对象（注意函数内部的this指向）\r\n\tlet data = vm.$options.data;\r\n\t// 关联 data（响应式数据getter和setter） 和 vm._data\r\n\tvm._data = data = isFunction(data) ? data.call(vm) : data;\r\n\t// 观测data（将其转换为响应式数据）\r\n\tobserve(data);\r\n}\r\n","import { initState } from './state';\r\n\r\n// 初始化vue\r\nexport function init(vm) {\r\n\t// 初始化state\r\n\tinitState(vm);\r\n}\r\n","import { init } from './init';\r\n\r\nfunction Vue(options) {\r\n\tconst vm = this;\r\n\tvm.$options = options;\r\n\tinit(vm);\r\n\treturn vm;\r\n}\r\n\r\nexport default Vue;\r\n"],"names":["isFunction","val","isObject","Object","prototype","toString","call","Observe","data","walk","keys","forEach","key","defineReactive","observe","defineProperty","get","set","newVal","initState","vm","opts","$options","initData","_data","init","Vue","options"],"mappings":";;;;;;CAAA;CAEO,SAASA,UAAT,CAAoBC,GAApB,EAAyB;GAC/B,OAAO,OAAOA,GAAP,KAAe,UAAtB,CAAA;CACA,CAAA;CAEM,SAASC,QAAT,CAAkBD,GAAlB,EAAuB;GAC7B,OAAOE,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BL,GAA/B,CAAA,KAAwC,iBAA/C,CAAA;CACA;;;;;;;;;;;;;;;;;;;;;;;;;;;CCJD,IAAaM,OAAb,gBAAA,YAAA;CACC,EAAA,SAAA,OAAA,CAAYC,IAAZ,EAAkB;CAAA,IAAA,eAAA,CAAA,IAAA,EAAA,OAAA,CAAA,CAAA;;CACjB;KACA,IAAKC,CAAAA,IAAL,CAAUD,IAAV,CAAA,CAAA;CACA,GAAA;;CAJF,EAAA,YAAA,CAAA,OAAA,EAAA,CAAA;CAAA,IAAA,GAAA,EAAA,MAAA;KAAA,KAKC,EAAA,SAAA,IAAA,CAAKA,IAAL,EAAW;OACVL,MAAM,CAACO,IAAP,CAAYF,IAAZ,EAAkBG,OAAlB,CAA0B,UAACC,GAAD,EAAS;SAClCC,cAAc,CAACL,IAAD,EAAOI,GAAP,EAAYJ,IAAI,CAACI,GAAD,CAAhB,CAAd,CAAA;QADD,CAAA,CAAA;CAGA,KAAA;CATF,GAAA,CAAA,CAAA,CAAA;;CAAA,EAAA,OAAA,OAAA,CAAA;CAAA,CAAA,EAAA,CAAA;;CAWA,SAASC,cAAT,CAAwBL,IAAxB,EAA8BI,GAA9B,EAAmCX,GAAnC,EAAwC;CACvC;GACAa,OAAO,CAACb,GAAD,CAAP,CAAA;CACAE,EAAAA,MAAM,CAACY,cAAP,CAAsBP,IAAtB,EAA4BI,GAA5B,EAAiC;CAChCI,IAAAA,GADgC,EAC1B,SAAA,GAAA,GAAA;CACL,MAAA,OAAOf,GAAP,CAAA;MAF+B;KAIhCgB,GAJgC,EAAA,SAAA,GAAA,CAI5BC,MAJ4B,EAIpB;CACX;OACAJ,OAAO,CAACI,MAAD,CAAP,CAAA;CACAjB,MAAAA,GAAG,GAAGiB,MAAN,CAAA;CACA,KAAA;IARF,CAAA,CAAA;CAUA,CAAA;;CAEM,SAASJ,OAAT,CAAiBN,IAAjB,EAAuB;CAC7B;CACA,EAAA,IAAI,CAACN,QAAQ,CAACM,IAAD,CAAb,EAAqB,OAAA;CACrB,EAAA,OAAO,IAAID,OAAJ,CAAYC,IAAZ,CAAP,CAAA;CACA;;CC9BM,SAASW,SAAT,CAAmBC,EAAnB,EAAuB;CAC7B,EAAA,IAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB,CAAA;;GACA,IAAID,IAAI,CAACb,IAAT,EAAe;KACde,QAAQ,CAACH,EAAD,CAAR,CAAA;CACA,GAAA;CACD;;CAGD,SAASG,QAAT,CAAkBH,EAAlB,EAAsB;CACrB;GACA,IAAIZ,IAAI,GAAGY,EAAE,CAACE,QAAH,CAAYd,IAAvB,CAFqB;;CAIrBY,EAAAA,EAAE,CAACI,KAAH,GAAWhB,IAAI,GAAGR,UAAU,CAACQ,IAAD,CAAV,GAAmBA,IAAI,CAACF,IAAL,CAAUc,EAAV,CAAnB,GAAmCZ,IAArD,CAJqB;;GAMrBM,OAAO,CAACN,IAAD,CAAP,CAAA;CACA;;CChBM,SAASiB,IAAT,CAAcL,EAAd,EAAkB;CACxB;GACAD,SAAS,CAACC,EAAD,CAAT,CAAA;CACA;;CCJD,SAASM,GAAT,CAAaC,OAAb,EAAsB;GACrB,IAAMP,EAAE,GAAG,IAAX,CAAA;GACAA,EAAE,CAACE,QAAH,GAAcK,OAAd,CAAA;GACAF,IAAI,CAACL,EAAD,CAAJ,CAAA;CACA,EAAA,OAAOA,EAAP,CAAA;CACA;;;;;;;;"}